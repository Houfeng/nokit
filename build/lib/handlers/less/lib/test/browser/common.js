/*csd*/var logMessages=[],realConsoleLog=console.log;console.log=function(a){logMessages.push(a);realConsoleLog.call(console,a);};var testLessEqualsInDocument=function(){testLessInDocument(testSheet);};var testLessErrorsInDocument=function(a){testLessInDocument(a?testErrorSheetConsole:testErrorSheet);};var testLessInDocument=function(c){var b=document.getElementsByTagName("link"),d=/^text\/(x-)?less$/;for(var a=0;a<b.length;a++){if(b[a].rel==="stylesheet/less"||(b[a].rel.match(/stylesheet/)&&(b[a].type.match(d)))){c(b[a]);}}};var testSheet=function(a){it(a.id+" should match the expected output",function(){var f=a.id.replace("original-",""),d="expected-"+f,g,e,c=document.getElementById(d).href,b=loadFile(c);waitsFor(function(){g=document.getElementById(f);return g!==null&&g.type==="text/css";},"generation of "+f+"",700);runs(function(){e=g.innerText||g.innerHTML;});waitsFor(function(){return b.loaded;},"failed to load expected outout",10000);runs(function(){expect(b.text).toEqual(e);});});};function extractId(a){return a.replace(/^[a-z-]+:\/+?[^\/]+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":");}var testErrorSheet=function(a){it(a.id+" should match an error",function(){var g=a.href,f="less-error-message:"+extractId(g),e=g.replace(/.less$/,".txt"),d=loadFile(e),b,c;waitsFor(function(){b=document.getElementById(f);return b!==null;},"error message was not generated",70);runs(function(){c=b.innerText.replace(/\n\d+/g,function(h){return h+" ";}).replace(/\n\s*in /g," in ").replace("\n\n","\n");});waitsFor(function(){return d.loaded;},"failed to load expected outout",10000);runs(function(){var h=d.text.replace("{path}","").replace("{pathrel}","").replace("{pathhref}","http://localhost:8081/test/less/errors/").replace("{404status}"," (404)");expect(h).toEqual(c);if(h==c){b.style.display="none";}});});};var testErrorSheetConsole=function(a){it(a.id+" should match an error",function(){var g=a.href,f=a.id.replace(/^original-less:/,"less-error-message:"),e=g.replace(/.less$/,".txt"),d=loadFile(e),b=document.getElementById(f),c=logMessages[logMessages.length-1];describe("the error",function(){expect(b).toBe(null);});waitsFor(function(){return d.loaded;},"failed to load expected outout",10000);runs(function(){var h=d.text.replace("{path}","").replace("{pathrel}","").replace("{pathhref}","http://localhost:8081/browser/less/").replace("{404status}"," (404)").trim();expect(h).toEqual(c);});});};var loadFile=function(a){var b=new XMLHttpRequest(),c={loaded:false,text:""};b.open("GET",a,true);b.onload=function(d){c.text=b.response.replace(/\r/g,"");c.loaded=true;};b.send();return c;};(function(){var d=jasmine.getEnv();d.updateInterval=1000;var c=new jasmine.HtmlReporter();d.addReporter(c);d.specFilter=function(e){return c.specFilter(e);};var a=window.onload;window.onload=function(){if(a){a();}b();};function b(){setTimeout(function(){d.execute();},3000);}})();