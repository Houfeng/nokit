/*csd*/(function(a){a.importVisitor=function(e,c,b,f,g){this._visitor=new a.visitor(this);this._importer=e;this._finish=c;this.env=b||new a.evalEnv();this.importCount=0;this.onceFileDetectionMap=f||{};this.recursionDetector={};if(g){for(var d in g){if(g.hasOwnProperty(d)){this.recursionDetector[d]=true;}}}};a.importVisitor.prototype={isReplacing:true,run:function(d){var c;try{this._visitor.visit(d);}catch(b){c=b;}this.isFinished=true;if(this.importCount===0){this._finish(c);}},visitImport:function(f,i){var g=this,d,h=f.options.inline;if(!f.css||h){try{d=f.evalForImport(this.env);}catch(b){if(!b.filename){b.index=f.index;b.filename=f.currentFileInfo.filename;}f.css=true;f.error=b;}if(d&&(!d.css||h)){f=d;this.importCount++;var c=new a.evalEnv(this.env,this.env.frames.slice(0));if(f.options.multiple){c.importMultiple=true;}this._importer.push(f.getPath(),f.currentFileInfo,f.options,function(k,n,m,l){if(k&&!k.filename){k.index=f.index;k.filename=f.currentFileInfo.filename;}if(!c.importMultiple){if(m){f.skip=true;}else{f.skip=function(){if(l in g.onceFileDetectionMap){return true;}g.onceFileDetectionMap[l]=true;return false;};}}var o=function(p){g.importCount--;if(g.importCount===0&&g.isFinished){g._finish(p);}};if(n){f.root=n;f.importedFilename=l;var j=m||l in g.recursionDetector;if(!h&&(c.importMultiple||!j)){g.recursionDetector[l]=true;new (a.importVisitor)(g._importer,o,c,g.onceFileDetectionMap,g.recursionDetector).run(n);return;}}o();});}}i.visitDeeper=false;return f;},visitRule:function(b,c){c.visitDeeper=false;return b;},visitDirective:function(b,c){this.env.frames.unshift(b);return b;},visitDirectiveOut:function(b){this.env.frames.shift();},visitMixinDefinition:function(b,c){this.env.frames.unshift(b);return b;},visitMixinDefinitionOut:function(b){this.env.frames.shift();},visitRuleset:function(b,c){this.env.frames.unshift(b);return b;},visitRulesetOut:function(b){this.env.frames.shift();},visitMedia:function(b,c){this.env.frames.unshift(b.ruleset);return b;},visitMediaOut:function(b){this.env.frames.shift();}};})(require("./tree"));