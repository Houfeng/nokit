/*csd*/var fs=require("fs");var path=require("path");var Handler=module.exports=function(b){var a=this;a.server=b;a.configs=a.server.configs;a.utils=a.server.require("./core/utils");};Handler.prototype.handleRequest=function(a){var c=this;try{c.handleFileSystem(a);}catch(b){a.responseError(b.message);}};Handler.prototype.handleFileSystem=function(a){var b=this;if(a.request.physicalPathExists){if(a.request.physicalPathType=="folder"){b.writeFolder(a);}else{b.writeFile(a);}}else{a.responseNotFound();}};Handler.prototype.writeFolder=function(a){var b=this;fs.readdir(a.request.physicalPath,function(c,d){if(c){a.responseError(c);return;}var e=[];d.forEach(function(g){var h=path.normalize(a.request.physicalPath+"/"+g);var i=fs.statSync(h);e.push({name:g,type:i.isDirectory()?"folder":"file"});});var f={server:b.server,handler:b,request:a.request,items:e};a.responseContent(b.server.responsePages["dir"](f),b.configs.mimeType[".html"]);});};Handler.prototype.writeFile=function(a){var b=this;fs.readFile(a.request.physicalPath,function(d,c){if(d){a.responseError(d);}else{a.responseContent(c);}});};